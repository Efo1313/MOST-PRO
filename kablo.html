<!DOCTYPE html>
<html lang="tr">
<head>    
    <meta charset="UTF-8">    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>IPTV Most Pro - Sunucu</title>    
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>    
    <style>        
        body { background: #000; color: #fff; text-align: center; font-family: sans-serif; margin: 0; }
        .player-box { position: sticky; top: 0; background: #000; padding: 15px; border-bottom: 2px solid #ff4500; z-index: 999; }
        video { width: 100%; max-width: 750px; border-radius: 10px; background: #111; box-shadow: 0 0 20px #ff450066; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; padding: 20px; }        
        button { background: #1a1a1a; color: #fff; border: 1px solid #444; padding: 12px; border-radius: 8px; cursor: pointer; transition: 0.3s; font-size: 13px; font-weight: bold; overflow: hidden; text-overflow: ellipsis; }        
        button:hover { background: #ff4500; border-color: #fff; transform: translateY(-3px); }
        #status { font-size: 14px; color: #ff4500; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>    

    <div class="player-box">        
        <h2 style="margin:0; color:#ff4500; font-size: 20px;">MOST PRO <span style="color:#fff">ARCHIVE</span></h2>
        <video id="video" controls autoplay playsinline></video>
        <div id="status">Sunucu taranıyor...</div>
    </div>    

    <div id="buttons" class="grid"></div>

    <script>        
        // Senin verdiğin açık sunucu adresi
        const ARCHIVE_URL = "http://85.11.144.8/archive/";

        async function loadArchive() {            
            try {                
                // Sunucu dizinini okumaya çalışıyoruz
                const res = await fetch(ARCHIVE_URL);
                const text = await res.text();
                
                // HTML içindeki dosya linklerini ayıklıyoruz
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');
                const links = Array.from(doc.querySelectorAll('a'));
                
                const btnDiv = document.getElementById('buttons');
                btnDiv.innerHTML = '';
                let count = 0;

                links.forEach(link => {
                    const href = link.getAttribute('href');
                    // Sadece video dosyalarını (m3u8 veya mp4) listele
                    if (href.endsWith('.m3u8') || href.endsWith('.mp4') || href.endsWith('.ts')) {
                        const btn = document.createElement('button');
                        btn.innerText = link.innerText.replace(/_/g, ' ').replace('.m3u8', '');
                        btn.onclick = () => play(ARCHIVE_URL + href, btn.innerText);
                        btnDiv.appendChild(btn);
                        count++;
                    }
                });

                if (count === 0) {
                    document.getElementById('status').innerText = "Arşivde oynatılabilir dosya bulunamadı.";
                } else {
                    document.getElementById('status').innerText = count + " Dosya Hazır!";
                }
            } catch (e) { 
                document.getElementById('status').innerText = "Sunucuya bağlanılamadı (CORS Engeli).";
                console.error(e);
            }        
        }

        function play(url, name) {            
            const video = document.getElementById('video');
            document.getElementById('status').innerText = "Oynatılıyor: " + name;
            
            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {                
                video.src = url;            
            }        
        }        
        loadArchive();    
    </script>
</body>
</html>
